
@{
    ViewBag.Title = "SaveFlightData";
}

<!DOCTYPE html>
<body background="~/export-map-share.png" style="background-size:100% 100%; background-attachment:fixed">
</body>
<canvas id="saveFlightCanvas" style='position:absolute; left:0px; top:0px;'></canvas>
<script>
        var IntervalTime = @Session["time"] * 1000;
        myTimer = (function () {
        // calls GetData function in the controller, inserts the output in "xml".
        $.post("@Url.Action("WriteData","Flight", new { path = @Session["path"] })").done(function (xml) {
            // parse the string "xml" into XML
            var xmlDoc = $.parseXML( xml ),
            $xml = $( xmlDoc ),
            // get longitude and latitude values
            Longtitude = $xml.find( "Longtitude" ).text();
            Latitude = $xml.find("Latitude").text();
            var lon = (parseFloat(Longtitude) + 180) * (ctx.canvas.width / 360);
            var lat = (parseFloat(Latitude) + 90) * (ctx.canvas.height / 180);
        });
    });
    // calls myTimer function every 4 seconds
    var interval = setInterval(myTimer, IntervalTime);
    // calls clearInterval, which stops "myTimer" after the given amount of seconds
    setTimeout(function () { clearInterval(interval); }, @Session["duaration"] * 1000);
    myTimer();
</script>

